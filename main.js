!function(){"use strict";var e={};function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}function r(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}e.p="";var o=function(){return e=function e(t,n,r,o,i,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._title=t.name,this._image=t.link,this._userId=r,this._likes=t.likes||[],this._id=t._id,this._handleLikeClick=c,this._template=n,this._handleCardClick=o,this._handleDeleteClick=i},(t=[{key:"_getTemplate",value:function(){return document.querySelector(this._template).content.querySelector(".grid__box").cloneNode(!0)}},{key:"_setEventListeners",value:function(){var e=this;this._element.querySelector(".grid__delete-button").addEventListener("click",(function(){e._handleTrashClick()})),this._element.querySelector(".grid__box-portrait-photo").addEventListener("click",(function(){e._handleImageClick()})),this._element.querySelector(".grid__content-like").addEventListener("click",(function(){e._handleLike()}))}},{key:"_handleTrashClick",value:function(){this._handleDeleteClick()}},{key:"_handleImageClick",value:function(){this._handleCardClick({name:this._title,link:this._image})}},{key:"setLike",value:function(e,t){this._isLiked=e,this._likeCard=this._element.querySelector(".grid__content-like"),this._isLiked?this._likeCard.classList.add("grid__content-like_active"):this._likeCard.classList.remove("grid__content-like_active"),this._element.querySelector(".grid__content-likeNumber").textContent=t}},{key:"_handleLike",value:function(){var e=this;this._handleLikeClick(this._id,this._isLiked).then((function(t){e.setLike(!e._isLiked,t.likes.length)})).catch((function(){}))}},{key:"deleteCard",value:function(){this._element.remove()}},{key:"addDeleteIcon",value:function(){this._element.querySelector(".grid__delete-button").classList.add("grid__delete-button_show")}},{key:"generateCard",value:function(){var e=this;this._element=this._getTemplate(),this._element.querySelector(".grid__box-portrait-photo").src=this._image,this._element.querySelector(".grid__box-portrait-photo").alt=this._title,this._element.querySelector(".grid__content-title").textContent=this._title;var t=this._likes.some((function(t){return t._id===e._userId}));return this.setLike(t,this._likes.length),this._setEventListeners(),this._element}}])&&n(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}var l=function(){return e=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._form=n,this._formSelector=t.formSelector,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass},(t=[{key:"_showInputError",value:function(e,t){this._errorElement=this._form.querySelector(".form__".concat(e.id,"-error")),e.classList.add(this._errorClass),t.tooShort?this._errorElement.textContent="Muito curto":t.badInput?this._errorElement.textContent="Campo inválido":t.customError?this._errorElement.textContent="Valor não aceito":t.patternMismatch?this._errorElement.textContent="Formato inválido":t.rangeOverflow?this._errorElement.textContent="Valor muito alto":t.rangeUnderflow?this._errorElement.textContent="Valor muito baixo":t.stepMismatch?this._errorElement.textContent="Valor inválido":t.tooLong?this._errorElement.textContent="Muito longo":t.typeMismatch?this._errorElement.textContent="Tipo de dado inválido":t.valueMissing&&(this._errorElement.textContent="Campo obrigatório")}},{key:"_hideInputError",value:function(e){this._errorElement=this._form.querySelector(".form__".concat(e.id,"-error")),e.classList.remove(this._errorClass),this._errorElement.textContent=""}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validity)}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled","")):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled"))}},{key:"_setEventListener",value:function(){var e=this;this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._buttonElement=this._form.querySelector(this._submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._setEventListener()}}])&&c(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function f(e){var t=function(e){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==a(t)?t:t+""}var p=function(){return e=function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=r,this._render=o,this._selector=document.querySelector(n)},(t=[{key:"renderer",value:function(){var e=this;this._items.forEach((function(t){e._render(t)}))}},{key:"addItem",value:function(e){this._selector.append(e)}}])&&s(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function v(e){var t=function(e){if("object"!=y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==y(t)?t:t+""}var b=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._selector=document.querySelector(t),this.open=this.open.bind(this),this._selector||console.log("Erro no seletor passado")},(t=[{key:"open",value:function(){this._selector.classList.add("grid__display_opened")}},{key:"close",value:function(){this._selector.classList.remove("grid__display_opened")}},{key:"_handleEscClose",value:function(e){this.close(),removeEventListener("keydown",this._handleEscClose)}},{key:"setEventListener",value:function(){var e,t,n=this;document.addEventListener("keydown",(function(e){"Escape"===e.key&&n._handleEscClose()})),null===(e=this._selector.querySelector(".popup__closer"))||void 0===e||e.addEventListener("click",(function(){n.close()})),null===(t=this._selector.querySelector("#popupOverlay"))||void 0===t||t.addEventListener("click",(function(e){e.target===e.currentTarget&&n.close()})),this._selector.addEventListener("click",(function(e){e.target===e.currentTarget&&n.close()}))}}])&&d(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function m(e){var t=function(e){if("object"!=h(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==h(t)?t:t+""}function g(e,t,n){return t=E(t),function(e,t){if(t&&("object"==h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,k()?Reflect.construct(t,n||[],E(e).constructor):t.apply(e,n))}function k(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(k=function(){return!!e})()}function S(e,t,n,r){var o=w(E(1&r?e.prototype:e),t,n);return 2&r?function(e){return o.apply(n,e)}:o}function w(){return w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=E(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},w.apply(null,arguments)}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}function O(e,t){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},O(e,t)}var j=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=g(this,t,[e]))._callback=n,r._isLoading=!1,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(t,e),n=t,(r=[{key:"_getInputValues",value:function(){var e,t,n,r;return{name:null===(e=this._selector.querySelector(".form__input-name"))||void 0===e?void 0:e.value,link:null===(t=this._selector.querySelector(".form__input-bio"))||void 0===t?void 0:t.value,about:null===(n=this._selector.querySelector(".form__input-bio"))||void 0===n?void 0:n.value,avatar:null===(r=this._selector.querySelector(".form__input-bio"))||void 0===r?void 0:r.value}}},{key:"close",value:function(){S(t,"close",this,3)([]),this._selector.querySelector(".form__button").classList.add("form__button_disabled"),this._selector.querySelector(".form__button").setAttribute("disabled",""),this._selector.querySelector(".form").reset()}},{key:"isLoading",value:function(e){var t=this._selector.querySelector(".form__button");this._isLoading=!this._isLoading,this._isLoading?t.textContent="Salvando...":t.textContent=e}},{key:"setEventListener",value:function(){var e=this;S(t,"setEventListener",this,3)([]),this._selector.querySelector(".form").addEventListener("submit",(function(t){t.preventDefault();var n=e._getInputValues();e._callback(n),e.isLoading("Salvar")}))}}])&&_(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(b);function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,L(r.key),r)}}function L(e){var t=function(e){if("object"!=C(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==C(t)?t:t+""}var q=function(){return e=function e(t){var n=t.name,r=t.bio,o=t.link;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=document.querySelector(n),this._bio=document.querySelector(r),this._link=document.querySelector(o)},(t=[{key:"getUserInfo",value:function(){return{name:this._name.textContent,bio:this._bio.textContent,link:this._link.src}}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about;this._name.textContent=t,this._bio.textContent=n}},{key:"setUserAvatar",value:function(e){this._link.src=e.avatar}}])&&P(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,x(r.key),r)}}function x(e){var t=function(e){if("object"!=T(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==T(t)?t:t+""}function U(e,t,n){return t=A(t),function(e,t){if(t&&("object"==T(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,D()?Reflect.construct(t,n||[],A(e).constructor):t.apply(e,n))}function D(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(D=function(){return!!e})()}function B(e,t,n,r){var o=R(A(1&r?e.prototype:e),t,n);return 2&r?function(e){return o.apply(n,e)}:o}function R(){return R="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=A(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},R.apply(null,arguments)}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}function V(e,t){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},V(e,t)}var N=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),U(this,t,[e])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V(e,t)}(t,e),n=t,(r=[{key:"open",value:function(e){this._selector.querySelector(".grid__display-image").src=e.link,this._selector.querySelector(".grid__display-image").alt=e.name,this._selector.querySelector(".grid__display-title").textContent=e.name,B(t,"open",this,3)([])}},{key:"close",value:function(){B(t,"close",this,3)([])}}])&&I(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(b);function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,z(r.key),r)}}function z(e){var t=function(e){if("object"!=M(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=M(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==M(t)?t:t+""}function H(e,t,n){return t=Q(t),function(e,t){if(t&&("object"==M(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,F()?Reflect.construct(t,n||[],Q(e).constructor):t.apply(e,n))}function F(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(F=function(){return!!e})()}function G(e,t,n,r){var o=K(Q(1&r?e.prototype:e),t,n);return 2&r?function(e){return o.apply(n,e)}:o}function K(){return K="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Q(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},K.apply(null,arguments)}function Q(e){return Q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Q(e)}function W(e,t){return W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},W(e,t)}var X=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=H(this,t,[e]))._deleteCallback=n,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&W(e,t)}(t,e),n=t,(r=[{key:"open",value:function(){G(t,"open",this,3)([])}},{key:"setEventListener",value:function(){var e=this;G(t,"setEventListener",this,3)([]),this._selector.querySelector(".form").addEventListener("submit",(function(t){t.preventDefault(),e._deleteCallback(),e.close()}))}}])&&J(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(b);function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){ee(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ee(e,t,n){return(t=ne(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ne(r.key),r)}}function ne(e){var t=function(e){if("object"!=Y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Y(t)?t:t+""}var re=function(){return e=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=t,this._options=n},(t=[{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),this._options).then((function(e){return e.ok?e.json():Promise.reject("Error manual: ".concat(e.status))})).catch((function(e){console.log("Vix paizao, deu ruim ó: ".concat(e))}))}},{key:"getUser",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),this._options).then((function(e){return e.ok?e.json():Promise.reject("Vixe amigo, erro ó: ".concat(e.status))}))}},{key:"setNewUser",value:function(e){fetch("".concat(this._baseUrl,"/users/me"),$($({method:"PATCH"},this._options),{},{body:JSON.stringify({name:e.name,about:e.about})}))}},{key:"setNewAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),$($({method:"PATCH"},this._options),{},{body:JSON.stringify({avatar:e.link})}))}},{key:"setNewCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),$($({method:"POST"},this._options),{},{body:JSON.stringify({name:e.name,link:e.link})})).then((function(e){return e.ok?e.json():Promise.reject("Post não enviado corretamente: ".concat(e.status))})).catch((function(e){console.log("Erro ao enviar novo Card: ".concat(e))}))}},{key:"apiLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),$({method:"PUT"},this._options)).then((function(e){return e.ok?e.json():Promise.reject("Erro de like: ".concat(e.status))}))}},{key:"apiDislike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),$({method:"DELETE"},this._options)).then((function(e){return e.ok?e.json():Promise.reject("Erro de dislike: ".concat(e.status))}))}},{key:"deleteCard",value:function(e){fetch("".concat(this._baseUrl,"/cards/").concat(e),$({method:"DELETE"},this._options)).then((function(e){console.log("Delete feito: ".concat(e))}))}}])&&te(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),oe=e.p+"cc6deb7349d71ca7a583.png",ie=new re("https://around.nomoreparties.co/v1/web-ptbr-cohort-12",{headers:{authorization:"c5f89901-0404-4ab2-ab83-c8e3c6dc51b4","Content-Type":"application/json"}});document.getElementById("closeIcon").src=oe;var ce=document.querySelector(".profile"),ue=ce.querySelector(".profile__button-add-post"),le=ce.querySelector(".profile__button-open-form"),ae=ce.querySelector(".profile__edit-pencil");ie.getUser().then((function(e){var t=e._id;ie.getInitialCards().then((function(e){var n=new p({items:e,renderer:function(e){var r=new o(e,"#grid",t,(function(e){var t=new N(".grid__display");t.open(e),t.setEventListener()}),(function(){var t=new X("#popupDeletePost",(function(){ie.deleteCard(e._id),r.deleteCard()}));t.open(),t.setEventListener()}),(function(){return e.likes.some((function(e){return e._id===t}))?ie.apiDislike(r._id).then((function(t){r.setLike(!1,t.likes.length),e.likes=t.likes})):ie.apiLike(r._id).then((function(t){r.setLike(!0,t.likes.length),e.likes=t.likes}))}));ie.getUser().then((function(t){t._id===e.owner._id&&r.addDeleteIcon()}));var i=r.generateCard(e);n.addItem(i)}},".grid");n.renderer()}))}));var se=new q({name:".profile__info-name",bio:".profile__info-bio",link:".profile__photo"});ie.getUser().then((function(e){se.setUserInfo(e),se.setUserAvatar(e)}));var fe=new j("#popupPost",(function(e){ie.getUser().then((function(t){var n=t._id,r=new o(e,"#grid",n,(function(e){var t=new N(".grid__display");t.open(e),t.setEventListener()}),(function(){}),(function(){})),i=document.querySelector(".grid");ie.setNewCard(e).then((function(e){r._id=e._id,r._handleDeleteClick=function(){var e=new X("#popupDeletePost",(function(){ie.deleteCard(r._id),r.deleteCard()}));e.open(),e.setEventListener()},r._handleLikeClick=function(){return e.likes.some((function(e){return e._id===n}))?ie.apiDislike(r._id).then((function(t){r.setLike(!1,t.likes.length),e.likes=t.likes})):ie.apiLike(r._id).then((function(t){r.setLike(!0,t.likes.length),e.likes=t.likes}))};var t=r.generateCard(e);ie.getUser().then((function(t){t._id===e.owner._id&&r.addDeleteIcon()})),i.prepend(t),fe.close(),fe.isLoading("Crie")}))}))}));fe.setEventListener();var pe=new j("#popupUser",(function(e){se.setUserInfo(e),ie.setNewUser(e),pe.close(),pe.isLoading("Salvar")}));pe.setEventListener();var ye=new j("#popupUserAvatar",(function(e){se.setUserAvatar(e),ie.setNewAvatar(e),ye.close(),ye.isLoading("Salvar")}));ye.setEventListener(),ae.addEventListener("click",(function(){ye.open()})),le.addEventListener("click",(function(){var e=se.getUserInfo();document.querySelector(".form__input-name").value=e.name,document.querySelector(".form__input-bio").value=e.bio,pe.open()})),ue.addEventListener("click",(function(){fe.open()}));var de={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input-error-message",errorClass:"form__input-error"};Array.from(document.querySelectorAll(de.formSelector)).forEach((function(e){new l(de,e).enableValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R0FDRixHQUNGLElBQ0EyRCxHQUFVYixtQkFFVixJQUFNbUIsR0FBWSxJQUFJbEYsRUFBYyxjQUFjLFNBQUM3SCxHQUNqRHNNLEdBQVNDLFlBQVl2TSxHQUNyQjRLLEdBQUlvQyxXQUFXaE4sR0FDZitNLEdBQVV6RixRQUNWeUYsR0FBVWpFLFVBQVUsU0FDdEIsSUFDQWlFLEdBQVVuQixtQkFFVixJQUFNcUIsR0FBYyxJQUFJcEYsRUFBYyxvQkFBb0IsU0FBQzdILEdBQ3pEc00sR0FBU0UsY0FBY3hNLEdBQ3ZCNEssR0FBSXNDLGFBQWFsTixHQUNqQmlOLEdBQVkzRixRQUNaMkYsR0FBWW5FLFVBQVUsU0FDeEIsSUFDQW1FLEdBQVlyQixtQkFFWlIsR0FBaUJ4SixpQkFBaUIsU0FBUyxXQUN6Q3FMLEdBQVloRyxNQUNkLElBRUFrRSxHQUFldkosaUJBQWlCLFNBQVMsV0FDdkMsSUFBTXVMLEVBQWlCYixHQUFTYyxjQUNoQzlMLFNBQVNDLGNBQWMscUJBQXFCRixNQUFROEwsRUFBZTFNLEtBQ25FYSxTQUFTQyxjQUFjLG9CQUFvQkYsTUFBUThMLEVBQWVuRSxJQUNsRStELEdBQVU5RixNQUNaLElBQ0FpRSxHQUFjdEosaUJBQWlCLFNBQVMsV0FDdEM2SyxHQUFVeEYsTUFDWixJQUVBLElBQU1vRyxHQUFZLENBQ2hCMUosYUFBYyxRQUNkRSxjQUFlLGVBQ2ZFLHFCQUFzQixnQkFDdEJFLG9CQUFxQix3QkFDckJFLGdCQUFpQiw0QkFDakJFLFdBQVkscUJBR0d5QixNQUFNQyxLQUFLekUsU0FBUzBFLGlCQUFpQnFILEdBQVUxSixlQUN2RHVDLFNBQVEsU0FBQ29ILEdBQ08sSUFBSWhLLEVBQWErSixHQUFXQyxHQUNqQkMsa0JBQ3BDLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIGRhdGEsXG4gICAgdGVtcGxhdGVTZWxlY3RvcixcbiAgICB1c2VySWQsXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VDbGlja1xuICApIHtcbiAgICB0aGlzLl90aXRsZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9pbWFnZSA9IGRhdGEubGluaztcblxuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXMgfHwgW107XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XG4gICAgdGhpcy5fdGVtcGxhdGUgPSB0ZW1wbGF0ZVNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZSlcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ3JpZF9fYm94XCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgcmV0dXJuIGNhcmRUZW1wbGF0ZTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9lbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5ncmlkX19kZWxldGUtYnV0dG9uXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5faGFuZGxlVHJhc2hDbGljaygpO1xuICAgICAgfSk7XG5cbiAgICB0aGlzLl9lbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5ncmlkX19ib3gtcG9ydHJhaXQtcGhvdG9cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKCk7XG4gICAgICB9KTtcblxuICAgIHRoaXMuX2VsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmdyaWRfX2NvbnRlbnQtbGlrZVwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZUxpa2UoKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgX2hhbmRsZVRyYXNoQ2xpY2soKSB7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2soKTtcbiAgfVxuXG4gIF9oYW5kbGVJbWFnZUNsaWNrKCkge1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh7IG5hbWU6IHRoaXMuX3RpdGxlLCBsaW5rOiB0aGlzLl9pbWFnZSB9KTtcbiAgfVxuXG4gIHNldExpa2UoaXNMaWtlZCwgbGlrZXNDb3VudCkge1xuICAgIHRoaXMuX2lzTGlrZWQgPSBpc0xpa2VkO1xuICAgIHRoaXMuX2xpa2VDYXJkID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdyaWRfX2NvbnRlbnQtbGlrZVwiKTtcblxuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9saWtlQ2FyZC5jbGFzc0xpc3QuYWRkKFwiZ3JpZF9fY29udGVudC1saWtlX2FjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fbGlrZUNhcmQuY2xhc3NMaXN0LnJlbW92ZShcImdyaWRfX2NvbnRlbnQtbGlrZV9hY3RpdmVcIik7XG4gICAgfVxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5ncmlkX19jb250ZW50LWxpa2VOdW1iZXJcIikudGV4dENvbnRlbnQgPVxuICAgICAgbGlrZXNDb3VudDtcbiAgfVxuXG4gIF9oYW5kbGVMaWtlKCkge1xuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzLl9pZCwgdGhpcy5faXNMaWtlZClcbiAgICAgIC50aGVuKCh1cGRhdGVkQ2FyZCkgPT4ge1xuICAgICAgICB0aGlzLnNldExpa2UoIXRoaXMuX2lzTGlrZWQsIHVwZGF0ZWRDYXJkLmxpa2VzLmxlbmd0aCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKCgpID0+IHt9KTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgfVxuXG4gIGFkZERlbGV0ZUljb24oKSB7XG4gICAgdGhpcy5fZWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZ3JpZF9fZGVsZXRlLWJ1dHRvblwiKVxuICAgICAgLmNsYXNzTGlzdC5hZGQoXCJncmlkX19kZWxldGUtYnV0dG9uX3Nob3dcIik7XG4gIH1cblxuICBnZW5lcmF0ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdyaWRfX2JveC1wb3J0cmFpdC1waG90b1wiKS5zcmMgPSB0aGlzLl9pbWFnZTtcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ3JpZF9fYm94LXBvcnRyYWl0LXBob3RvXCIpLmFsdCA9IHRoaXMuX3RpdGxlO1xuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5ncmlkX19jb250ZW50LXRpdGxlXCIpLnRleHRDb250ZW50ID1cbiAgICAgIHRoaXMuX3RpdGxlO1xuXG4gICAgY29uc3QgaGFzT3duTGlrZSA9IHRoaXMuX2xpa2VzLnNvbWUoKGxpa2UpID0+IGxpa2UuX2lkID09PSB0aGlzLl91c2VySWQpO1xuICAgIHRoaXMuc2V0TGlrZShoYXNPd25MaWtlLCB0aGlzLl9saWtlcy5sZW5ndGgpO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRpdHkge1xyXG4gIGNvbnN0cnVjdG9yKHNlbGVjdG9yLCBmb3JtKSB7XHJcbiAgICB0aGlzLl9mb3JtID0gZm9ybTtcclxuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IHNlbGVjdG9yLmZvcm1TZWxlY3RvcjtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZWxlY3Rvci5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZWxlY3Rvci5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZWxlY3Rvci5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2VsZWN0b3IuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNlbGVjdG9yLmVycm9yQ2xhc3M7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvclZhbGlkKSB7XHJcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAuZm9ybV9fJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG5cclxuICAgIGlmIChlcnJvclZhbGlkLnRvb1Nob3J0KSB7XHJcbiAgICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiTXVpdG8gY3VydG9cIjtcclxuICAgIH0gZWxzZSBpZiAoZXJyb3JWYWxpZC5iYWRJbnB1dCkge1xyXG4gICAgICB0aGlzLl9lcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIkNhbXBvIGludsOhbGlkb1wiO1xyXG4gICAgfSBlbHNlIGlmIChlcnJvclZhbGlkLmN1c3RvbUVycm9yKSB7XHJcbiAgICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiVmFsb3IgbsOjbyBhY2VpdG9cIjtcclxuICAgIH0gZWxzZSBpZiAoZXJyb3JWYWxpZC5wYXR0ZXJuTWlzbWF0Y2gpIHtcclxuICAgICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJGb3JtYXRvIGludsOhbGlkb1wiO1xyXG4gICAgfSBlbHNlIGlmIChlcnJvclZhbGlkLnJhbmdlT3ZlcmZsb3cpIHtcclxuICAgICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJWYWxvciBtdWl0byBhbHRvXCI7XHJcbiAgICB9IGVsc2UgaWYgKGVycm9yVmFsaWQucmFuZ2VVbmRlcmZsb3cpIHtcclxuICAgICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJWYWxvciBtdWl0byBiYWl4b1wiO1xyXG4gICAgfSBlbHNlIGlmIChlcnJvclZhbGlkLnN0ZXBNaXNtYXRjaCkge1xyXG4gICAgICB0aGlzLl9lcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlZhbG9yIGludsOhbGlkb1wiO1xyXG4gICAgfSBlbHNlIGlmIChlcnJvclZhbGlkLnRvb0xvbmcpIHtcclxuICAgICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJNdWl0byBsb25nb1wiO1xyXG4gICAgfSBlbHNlIGlmIChlcnJvclZhbGlkLnR5cGVNaXNtYXRjaCkge1xyXG4gICAgICB0aGlzLl9lcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlRpcG8gZGUgZGFkbyBpbnbDoWxpZG9cIjtcclxuICAgIH0gZWxzZSBpZiAoZXJyb3JWYWxpZC52YWx1ZU1pc3NpbmcpIHtcclxuICAgICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJDYW1wbyBvYnJpZ2F0w7NyaW9cIjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2Vycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC5mb3JtX18ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRpdHkpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcigpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcigpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjbGFzc1NlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9zZWxlY3RvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY2xhc3NTZWxlY3Rvcik7XHJcbiAgfVxyXG4gIHJlbmRlcmVyKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXIoaXRlbSk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgYWRkSXRlbShpdGVtKSB7XHJcbiAgICB0aGlzLl9zZWxlY3Rvci5hcHBlbmQoaXRlbSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3NlbGVjdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLm9wZW4gPSB0aGlzLm9wZW4uYmluZCh0aGlzKTtcbiAgICBpZiAoIXRoaXMuX3NlbGVjdG9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIkVycm8gbm8gc2VsZXRvciBwYXNzYWRvXCIpO1xuICAgIH1cbiAgfVxuICBvcGVuKCkge1xuICAgIHRoaXMuX3NlbGVjdG9yLmNsYXNzTGlzdC5hZGQoXCJncmlkX19kaXNwbGF5X29wZW5lZFwiKTtcbiAgfVxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9zZWxlY3Rvci5jbGFzc0xpc3QucmVtb3ZlKFwiZ3JpZF9fZGlzcGxheV9vcGVuZWRcIik7XG4gIH1cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIHRoaXMuY2xvc2UoKTtcbiAgICByZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cbiAgc2V0RXZlbnRMaXN0ZW5lcigpIHtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuX3NlbGVjdG9yXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2VyXCIpXG4gICAgICA/LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH0pO1xuICAgIHRoaXMuX3NlbGVjdG9yXG4gICAgICAucXVlcnlTZWxlY3RvcihcIiNwb3B1cE92ZXJsYXlcIilcbiAgICAgID8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICAgICAgaWYgKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XG4gICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB0aGlzLl9zZWxlY3Rvci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgICAgaWYgKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHNlbGVjdG9yLCBjYWxsYmFjaykge1xuICAgIHN1cGVyKHNlbGVjdG9yKTtcbiAgICB0aGlzLl9jYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIHRoaXMuX2lzTG9hZGluZyA9IGZhbHNlO1xuICB9XG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fc2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5mb3JtX19pbnB1dC1uYW1lXCIpPy52YWx1ZSxcbiAgICAgIGxpbms6IHRoaXMuX3NlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXQtYmlvXCIpPy52YWx1ZSxcbiAgICAgIGFib3V0OiB0aGlzLl9zZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0LWJpb1wiKT8udmFsdWUsXG4gICAgICBhdmF0YXI6IHRoaXMuX3NlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXQtYmlvXCIpPy52YWx1ZSxcbiAgICB9O1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9zZWxlY3RvclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fYnV0dG9uXCIpXG4gICAgICAuY2xhc3NMaXN0LmFkZChcImZvcm1fX2J1dHRvbl9kaXNhYmxlZFwiKTtcbiAgICB0aGlzLl9zZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2J1dHRvblwiKS5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcIlwiKTtcbiAgICB0aGlzLl9zZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIikucmVzZXQoKTtcbiAgfVxuXG4gIGlzTG9hZGluZyhtZXNzYWdlKSB7XG4gICAgY29uc3Qgc3VibWl0QnV0dG9uID0gdGhpcy5fc2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5mb3JtX19idXR0b25cIik7XG4gICAgdGhpcy5faXNMb2FkaW5nID0gIXRoaXMuX2lzTG9hZGluZztcbiAgICBpZiAodGhpcy5faXNMb2FkaW5nKSB7XG4gICAgICBzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhbHZhbmRvLi4uXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcigpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVyKCk7XG4gICAgdGhpcy5fc2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBjb25zdCBkYXRhID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcbiAgICAgIHRoaXMuX2NhbGxiYWNrKGRhdGEpO1xuICAgICAgdGhpcy5pc0xvYWRpbmcoXCJTYWx2YXJcIik7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lLCBiaW8sIGxpbmsgfSkge1xuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWUpO1xuICAgIHRoaXMuX2JpbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYmlvKTtcbiAgICB0aGlzLl9saW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihsaW5rKTtcbiAgfVxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcbiAgICAgIGJpbzogdGhpcy5fYmlvLnRleHRDb250ZW50LFxuICAgICAgbGluazogdGhpcy5fbGluay5zcmMsXG4gICAgfTtcbiAgfVxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9iaW8udGV4dENvbnRlbnQgPSBhYm91dDtcbiAgfVxuXG4gIHNldFVzZXJBdmF0YXIoZGF0YSkge1xuICAgIHRoaXMuX2xpbmsuc3JjID0gZGF0YS5hdmF0YXI7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3Ioc2VsZWN0b3IpIHtcbiAgICBzdXBlcihzZWxlY3Rvcik7XG4gIH1cbiAgb3BlbihpbWFnZSkge1xuICAgIHRoaXMuX3NlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIuZ3JpZF9fZGlzcGxheS1pbWFnZVwiKS5zcmMgPSBpbWFnZS5saW5rO1xuICAgIHRoaXMuX3NlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIuZ3JpZF9fZGlzcGxheS1pbWFnZVwiKS5hbHQgPSBpbWFnZS5uYW1lO1xuICAgIGNvbnN0IHN1YnRpdGxlRGlzcGxheSA9IHRoaXMuX3NlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5ncmlkX19kaXNwbGF5LXRpdGxlXCJcbiAgICApO1xuICAgIHN1YnRpdGxlRGlzcGxheS50ZXh0Q29udGVudCA9IGltYWdlLm5hbWU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3RvcihzZWxlY3RvciwgZGVsZXRlQ2FsbGJhY2spIHtcclxuICAgIHN1cGVyKHNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2RlbGV0ZUNhbGxiYWNrID0gZGVsZXRlQ2FsbGJhY2s7XHJcbiAgfVxyXG4gIG9wZW4oKSB7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG4gIHNldEV2ZW50TGlzdGVuZXIoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVyKCk7XHJcbiAgICB0aGlzLl9zZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIikuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9kZWxldGVDYWxsYmFjaygpO1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoYmFzZVVSTCwgb3B0aW9ucykge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVVJMO1xuICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zO1xuICAgIC8vdGhpcy5fbGlrZSA9IGNhbGxiYWNrTGlrZTtcbiAgfVxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwgdGhpcy5fb3B0aW9ucylcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3IgbWFudWFsOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBWaXggcGFpemFvLCBkZXUgcnVpbSDDszogJHtlcnJvcn1gKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZ2V0VXNlcigpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB0aGlzLl9vcHRpb25zKS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYFZpeGUgYW1pZ28sIGVycm8gw7M6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICBzZXROZXdVc2VyKGRhdGEpIHtcbiAgICBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgLi4udGhpcy5fb3B0aW9ucyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICBhYm91dDogZGF0YS5hYm91dCxcbiAgICAgIH0pLFxuICAgIH0pO1xuICB9XG4gIHNldE5ld0F2YXRhcihkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgLi4udGhpcy5fb3B0aW9ucyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiBkYXRhLmxpbmssXG4gICAgICB9KSxcbiAgICB9KTtcbiAgfVxuICBzZXROZXdDYXJkKGRhdGEpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgLi4udGhpcy5fb3B0aW9ucyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICBsaW5rOiBkYXRhLmxpbmssXG4gICAgICB9KSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBQb3N0IG7Do28gZW52aWFkbyBjb3JyZXRhbWVudGU6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coYEVycm8gYW8gZW52aWFyIG5vdm8gQ2FyZDogJHtlcnJvcn1gKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgYXBpTGlrZShpZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIC4uLnRoaXMuX29wdGlvbnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvIGRlIGxpa2U6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICBhcGlEaXNsaWtlKGlkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7aWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgLi4udGhpcy5fb3B0aW9ucyxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm8gZGUgZGlzbGlrZTogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChpZCkge1xuICAgIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgLi4udGhpcy5fb3B0aW9ucyxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGBEZWxldGUgZmVpdG86ICR7cmVzfWApO1xuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgXCIuL21haW4uY3NzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkaXR5IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgeyBQb3B1cFdpdGhDb25maXJtYXRpb24gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5pbXBvcnQgY2xvc2VJY29ucG5nIGZyb20gXCIuL2ltYWdlcy9wb3B1cF9fY2xvc2VpY29uLnBuZ1wiO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKGBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL3dlYi1wdGJyLWNvaG9ydC0xMmAsIHtcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiYzVmODk5MDEtMDQwNC00YWIyLWFiODMtYzhlM2M2ZGM1MWI0XCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuY29uc3QgY2xvc2VJY29uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjbG9zZUljb25cIik7XG5jbG9zZUljb24uc3JjID0gY2xvc2VJY29ucG5nO1xuXG5jb25zdCBwcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlXCIpO1xuY29uc3QgYWRkUG9zdEJ1dHRvbiA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19idXR0b24tYWRkLXBvc3RcIik7XG5jb25zdCBidXR0b25PcGVuRm9ybSA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19idXR0b24tb3Blbi1mb3JtXCIpO1xuY29uc3QgZWRpdEF2YXRhckJ1dHRvbiA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LXBlbmNpbFwiKTtcblxuYXBpLmdldFVzZXIoKS50aGVuKCh1c2VyRGF0YSkgPT4ge1xuICBjb25zdCB1c2VySWQgPSB1c2VyRGF0YS5faWQ7XG4gIGFwaS5nZXRJbml0aWFsQ2FyZHMoKS50aGVuKChpbml0aWFsQ2FyZHMpID0+IHtcbiAgICBjb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gICAgICB7XG4gICAgICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXG4gICAgICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICAgICAgICAgIGl0ZW0sXG4gICAgICAgICAgICBcIiNncmlkXCIsXG4gICAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgICAoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBwb3B1cFdpdGhJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIi5ncmlkX19kaXNwbGF5XCIpO1xuICAgICAgICAgICAgICBwb3B1cFdpdGhJbWFnZS5vcGVuKGRhdGEpO1xuICAgICAgICAgICAgICBwb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVyKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBkZWxldGVGb3JtID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihcbiAgICAgICAgICAgICAgICBcIiNwb3B1cERlbGV0ZVBvc3RcIixcbiAgICAgICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICBhcGkuZGVsZXRlQ2FyZChpdGVtLl9pZCk7XG4gICAgICAgICAgICAgICAgICBjYXJkLmRlbGV0ZUNhcmQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgZGVsZXRlRm9ybS5vcGVuKCk7XG4gICAgICAgICAgICAgIGRlbGV0ZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcigpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgaGFzT3duTGlrZSA9IGl0ZW0ubGlrZXMuc29tZSgobGlrZSkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBsaWtlLl9pZCA9PT0gdXNlcklkO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgaWYgKGhhc093bkxpa2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXBpLmFwaURpc2xpa2UoY2FyZC5faWQpLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XG4gICAgICAgICAgICAgICAgICBjYXJkLnNldExpa2UoZmFsc2UsIHVwZGF0ZWRDYXJkLmxpa2VzLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICBpdGVtLmxpa2VzID0gdXBkYXRlZENhcmQubGlrZXM7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFwaS5hcGlMaWtlKGNhcmQuX2lkKS50aGVuKCh1cGRhdGVkQ2FyZCkgPT4ge1xuICAgICAgICAgICAgICAgICAgY2FyZC5zZXRMaWtlKHRydWUsIHVwZGF0ZWRDYXJkLmxpa2VzLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICBpdGVtLmxpa2VzID0gdXBkYXRlZENhcmQubGlrZXM7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICApO1xuXG4gICAgICAgICAgYXBpLmdldFVzZXIoKS50aGVuKCh1c2VyRGF0YSkgPT4ge1xuICAgICAgICAgICAgaWYgKHVzZXJEYXRhLl9pZCA9PT0gaXRlbS5vd25lci5faWQpIHtcbiAgICAgICAgICAgICAgY2FyZC5hZGREZWxldGVJY29uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVDYXJkKGl0ZW0pO1xuICAgICAgICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgXCIuZ3JpZFwiXG4gICAgKTtcbiAgICBzZWN0aW9uLnJlbmRlcmVyKCk7XG4gIH0pO1xufSk7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZTogXCIucHJvZmlsZV9faW5mby1uYW1lXCIsXG4gIGJpbzogXCIucHJvZmlsZV9faW5mby1iaW9cIixcbiAgbGluazogXCIucHJvZmlsZV9fcGhvdG9cIixcbn0pO1xuXG5hcGkuZ2V0VXNlcigpLnRoZW4oKHVzZXJEYXRhKSA9PiB7XG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhKTtcbiAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YSk7XG59KTtcblxuY29uc3QgcG9wdXBGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcG9wdXBQb3N0XCIsIChkYXRhKSA9PiB7XG4gIGFwaS5nZXRVc2VyKCkudGhlbigodXNlckRhdGEpID0+IHtcbiAgICBjb25zdCB1c2VySWQgPSB1c2VyRGF0YS5faWQ7XG5cbiAgICBjb25zdCBuZXdDYXJkID0gbmV3IENhcmQoXG4gICAgICBkYXRhLFxuICAgICAgXCIjZ3JpZFwiLFxuICAgICAgdXNlcklkLFxuICAgICAgKGRhdGEpID0+IHtcbiAgICAgICAgY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIuZ3JpZF9fZGlzcGxheVwiKTtcbiAgICAgICAgcG9wdXBXaXRoSW1hZ2Uub3BlbihkYXRhKTtcbiAgICAgICAgcG9wdXBXaXRoSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcigpO1xuICAgICAgfSxcbiAgICAgICgpID0+IHt9LFxuICAgICAgKCkgPT4ge31cbiAgICApO1xuICAgIGNvbnN0IGZlZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdyaWRcIik7XG4gICAgYXBpLnNldE5ld0NhcmQoZGF0YSkudGhlbigoY2FyZCkgPT4ge1xuICAgICAgbmV3Q2FyZC5faWQgPSBjYXJkLl9pZDtcbiAgICAgIG5ld0NhcmQuX2hhbmRsZURlbGV0ZUNsaWNrID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBkZWxldGVGb3JtID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihcIiNwb3B1cERlbGV0ZVBvc3RcIiwgKCkgPT4ge1xuICAgICAgICAgIGFwaS5kZWxldGVDYXJkKG5ld0NhcmQuX2lkKTtcbiAgICAgICAgICBuZXdDYXJkLmRlbGV0ZUNhcmQoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGRlbGV0ZUZvcm0ub3BlbigpO1xuICAgICAgICBkZWxldGVGb3JtLnNldEV2ZW50TGlzdGVuZXIoKTtcbiAgICAgIH07XG5cbiAgICAgIG5ld0NhcmQuX2hhbmRsZUxpa2VDbGljayA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgaGFzT3duTGlrZSA9IGNhcmQubGlrZXMuc29tZSgobGlrZSkgPT4ge1xuICAgICAgICAgIHJldHVybiBsaWtlLl9pZCA9PT0gdXNlcklkO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGhhc093bkxpa2UpIHtcbiAgICAgICAgICByZXR1cm4gYXBpLmFwaURpc2xpa2UobmV3Q2FyZC5faWQpLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XG4gICAgICAgICAgICBuZXdDYXJkLnNldExpa2UoZmFsc2UsIHVwZGF0ZWRDYXJkLmxpa2VzLmxlbmd0aCk7XG4gICAgICAgICAgICBjYXJkLmxpa2VzID0gdXBkYXRlZENhcmQubGlrZXM7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIGFwaS5hcGlMaWtlKG5ld0NhcmQuX2lkKS50aGVuKCh1cGRhdGVkQ2FyZCkgPT4ge1xuICAgICAgICAgICAgbmV3Q2FyZC5zZXRMaWtlKHRydWUsIHVwZGF0ZWRDYXJkLmxpa2VzLmxlbmd0aCk7XG4gICAgICAgICAgICBjYXJkLmxpa2VzID0gdXBkYXRlZENhcmQubGlrZXM7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IG5ld0NhcmRFbGVtZW50ID0gbmV3Q2FyZC5nZW5lcmF0ZUNhcmQoY2FyZCk7XG4gICAgICBhcGkuZ2V0VXNlcigpLnRoZW4oKHVzZXJEYXRhKSA9PiB7XG4gICAgICAgIGlmICh1c2VyRGF0YS5faWQgPT09IGNhcmQub3duZXIuX2lkKSB7XG4gICAgICAgICAgbmV3Q2FyZC5hZGREZWxldGVJY29uKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBmZWVkLnByZXBlbmQobmV3Q2FyZEVsZW1lbnQpO1xuICAgICAgcG9wdXBGb3JtLmNsb3NlKCk7XG4gICAgICBwb3B1cEZvcm0uaXNMb2FkaW5nKFwiQ3JpZVwiKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbnBvcHVwRm9ybS5zZXRFdmVudExpc3RlbmVyKCk7XG5cbmNvbnN0IHBvcHVwVXNlciA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3BvcHVwVXNlclwiLCAoZGF0YSkgPT4ge1xuICB1c2VySW5mby5zZXRVc2VySW5mbyhkYXRhKTtcbiAgYXBpLnNldE5ld1VzZXIoZGF0YSk7XG4gIHBvcHVwVXNlci5jbG9zZSgpO1xuICBwb3B1cFVzZXIuaXNMb2FkaW5nKFwiU2FsdmFyXCIpO1xufSk7XG5wb3B1cFVzZXIuc2V0RXZlbnRMaXN0ZW5lcigpO1xuXG5jb25zdCBwb3B1cEF2YXRhciA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3BvcHVwVXNlckF2YXRhclwiLCAoZGF0YSkgPT4ge1xuICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKGRhdGEpO1xuICBhcGkuc2V0TmV3QXZhdGFyKGRhdGEpO1xuICBwb3B1cEF2YXRhci5jbG9zZSgpO1xuICBwb3B1cEF2YXRhci5pc0xvYWRpbmcoXCJTYWx2YXJcIik7XG59KTtcbnBvcHVwQXZhdGFyLnNldEV2ZW50TGlzdGVuZXIoKTtcblxuZWRpdEF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBwb3B1cEF2YXRhci5vcGVuKCk7XG59KTtcblxuYnV0dG9uT3BlbkZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY29uc3QgY3VycmVudFByb2ZpbGUgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0LW5hbWVcIikudmFsdWUgPSBjdXJyZW50UHJvZmlsZS5uYW1lO1xuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0LWJpb1wiKS52YWx1ZSA9IGN1cnJlbnRQcm9maWxlLmJpbztcbiAgcG9wdXBVc2VyLm9wZW4oKTtcbn0pO1xuYWRkUG9zdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBwb3B1cEZvcm0ub3BlbigpO1xufSk7XG5cbmNvbnN0IHNlbGVjdG9ycyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJmb3JtX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0LWVycm9yLW1lc3NhZ2VcIixcbiAgZXJyb3JDbGFzczogXCJmb3JtX19pbnB1dC1lcnJvclwiLFxufTtcblxuY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3JzLmZvcm1TZWxlY3RvcikpO1xuZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcbiAgY29uc3QgZm9ybVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkaXR5KHNlbGVjdG9ycywgZm9ybUVsZW1lbnQpO1xuICBjb25zdCBmb3JtRW5hYmxlID0gZm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xufSk7XG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInAiLCJDYXJkIiwiZGF0YSIsInRlbXBsYXRlU2VsZWN0b3IiLCJ1c2VySWQiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VDbGljayIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJfdGl0bGUiLCJuYW1lIiwiX2ltYWdlIiwibGluayIsIl91c2VySWQiLCJfbGlrZXMiLCJsaWtlcyIsIl9pZCIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfdGVtcGxhdGUiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwia2V5IiwidmFsdWUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3RoaXMiLCJfZWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlVHJhc2hDbGljayIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZUxpa2UiLCJpc0xpa2VkIiwibGlrZXNDb3VudCIsIl9pc0xpa2VkIiwiX2xpa2VDYXJkIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwidGV4dENvbnRlbnQiLCJfdGhpczIiLCJ0aGVuIiwidXBkYXRlZENhcmQiLCJzZXRMaWtlIiwibGVuZ3RoIiwiY2F0Y2giLCJfdGhpczMiLCJfZ2V0VGVtcGxhdGUiLCJzcmMiLCJhbHQiLCJoYXNPd25MaWtlIiwic29tZSIsImxpa2UiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJGb3JtVmFsaWRpdHkiLCJzZWxlY3RvciIsImZvcm0iLCJfZm9ybSIsIl9mb3JtU2VsZWN0b3IiLCJmb3JtU2VsZWN0b3IiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJpbnB1dEVsZW1lbnQiLCJlcnJvclZhbGlkIiwiX2Vycm9yRWxlbWVudCIsImNvbmNhdCIsImlkIiwidG9vU2hvcnQiLCJiYWRJbnB1dCIsImN1c3RvbUVycm9yIiwicGF0dGVybk1pc21hdGNoIiwicmFuZ2VPdmVyZmxvdyIsInJhbmdlVW5kZXJmbG93Iiwic3RlcE1pc21hdGNoIiwidG9vTG9uZyIsInR5cGVNaXNtYXRjaCIsInZhbHVlTWlzc2luZyIsIl9pbnB1dExpc3QiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9idXR0b25FbGVtZW50Iiwic2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImZvckVhY2giLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3NldEV2ZW50TGlzdGVuZXIiLCJTZWN0aW9uIiwiX3JlZiIsImNsYXNzU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlciIsIl9zZWxlY3RvciIsIml0ZW0iLCJhcHBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJvcGVuIiwiYmluZCIsImNvbnNvbGUiLCJsb2ciLCJldnQiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlRXNjQ2xvc2UiLCJfdGhpcyRfc2VsZWN0b3IkcXVlcnkiLCJfdGhpcyRfc2VsZWN0b3IkcXVlcnkyIiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsIlBvcHVwV2l0aEZvcm0iLCJfUG9wdXAiLCJjYWxsYmFjayIsIl9jYWxsU3VwZXIiLCJfY2FsbGJhY2siLCJfaXNMb2FkaW5nIiwiX2luaGVyaXRzIiwiX3RoaXMkX3NlbGVjdG9yJHF1ZXJ5MyIsIl90aGlzJF9zZWxlY3RvciRxdWVyeTQiLCJhYm91dCIsImF2YXRhciIsIl9zdXBlclByb3BHZXQiLCJyZXNldCIsIm1lc3NhZ2UiLCJzdWJtaXRCdXR0b24iLCJwcmV2ZW50RGVmYXVsdCIsIl9nZXRJbnB1dFZhbHVlcyIsImlzTG9hZGluZyIsIlVzZXJJbmZvIiwiYmlvIiwiX25hbWUiLCJfYmlvIiwiX2xpbmsiLCJfcmVmMiIsIlBvcHVwV2l0aEltYWdlIiwiaW1hZ2UiLCJQb3B1cFdpdGhDb25maXJtYXRpb24iLCJkZWxldGVDYWxsYmFjayIsIl9kZWxldGVDYWxsYmFjayIsIkFwaSIsImJhc2VVUkwiLCJvcHRpb25zIiwiX2Jhc2VVcmwiLCJfb3B0aW9ucyIsImZldGNoIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImVycm9yIiwiX29iamVjdFNwcmVhZCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYXBpIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJnZXRFbGVtZW50QnlJZCIsImNsb3NlSWNvbnBuZyIsInByb2ZpbGUiLCJhZGRQb3N0QnV0dG9uIiwiYnV0dG9uT3BlbkZvcm0iLCJlZGl0QXZhdGFyQnV0dG9uIiwiZ2V0VXNlciIsInVzZXJEYXRhIiwiZ2V0SW5pdGlhbENhcmRzIiwiaW5pdGlhbENhcmRzIiwic2VjdGlvbiIsImNhcmQiLCJwb3B1cFdpdGhJbWFnZSIsInNldEV2ZW50TGlzdGVuZXIiLCJkZWxldGVGb3JtIiwiZGVsZXRlQ2FyZCIsImFwaURpc2xpa2UiLCJhcGlMaWtlIiwib3duZXIiLCJhZGREZWxldGVJY29uIiwiY2FyZEVsZW1lbnQiLCJnZW5lcmF0ZUNhcmQiLCJhZGRJdGVtIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsInNldFVzZXJBdmF0YXIiLCJwb3B1cEZvcm0iLCJuZXdDYXJkIiwiZmVlZCIsInNldE5ld0NhcmQiLCJuZXdDYXJkRWxlbWVudCIsInByZXBlbmQiLCJwb3B1cFVzZXIiLCJzZXROZXdVc2VyIiwicG9wdXBBdmF0YXIiLCJzZXROZXdBdmF0YXIiLCJjdXJyZW50UHJvZmlsZSIsImdldFVzZXJJbmZvIiwic2VsZWN0b3JzIiwiZm9ybUVsZW1lbnQiLCJlbmFibGVWYWxpZGF0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==