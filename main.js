!function(){"use strict";var e={};function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}function r(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}e.p="";var o=function(){return e=function e(t,n,r,o,i,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._title=t.name,this._image=t.link,this._userId=r,this._likes=t.likes||[],this._id=t._id,this._handleLikeClick=c,this._template=n,this._handleCardClick=o,this._handleDeleteClick=i},(t=[{key:"_getTemplate",value:function(){return document.querySelector(this._template).content.querySelector(".grid__box").cloneNode(!0)}},{key:"_setEventListeners",value:function(){var e=this;this._element.querySelector(".grid__delete-button").addEventListener("click",(function(){e._handleTrashClick()})),this._element.querySelector(".grid__box-portrait-photo").addEventListener("click",(function(){e._handleImageClick()})),this._element.querySelector(".grid__content-like").addEventListener("click",(function(){e._handleLike()}))}},{key:"_handleTrashClick",value:function(){this._handleDeleteClick()}},{key:"_handleImageClick",value:function(){this._handleCardClick({name:this._title,link:this._image})}},{key:"setLike",value:function(e,t){this._isLiked=e,this._likeCard=this._element.querySelector(".grid__content-like"),this._isLiked?this._likeCard.classList.add("grid__content-like_active"):this._likeCard.classList.remove("grid__content-like_active"),this._element.querySelector(".grid__content-likeNumber").textContent=t}},{key:"_handleLike",value:function(){var e=this;this._handleLikeClick(this._id,this._isLiked).then((function(t){e.setLike(!e._isLiked,t.likes.length)})).catch((function(){}))}},{key:"deleteCard",value:function(){this._element.remove()}},{key:"addDeleteIcon",value:function(){this._element.querySelector(".grid__delete-button").classList.add("grid__delete-button_show")}},{key:"generateCard",value:function(){var e=this;this._element=this._getTemplate(),this._element.querySelector(".grid__box-portrait-photo").src=this._image,this._element.querySelector(".grid__box-portrait-photo").alt=this._title,this._element.querySelector(".grid__content-title").textContent=this._title;var t=this._likes.some((function(t){return t._id===e._userId}));return this.setLike(t,this._likes.length),this._setEventListeners(),this._element}}])&&n(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}var l=function(){return e=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._form=n,this._formSelector=t.formSelector,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass},(t=[{key:"_showInputError",value:function(e,t){this._errorElement=this._form.querySelector(".form__".concat(e.id,"-error")),e.classList.add(this._errorClass),t.tooShort?this._errorElement.textContent="Muito curto":t.badInput?this._errorElement.textContent="Campo inválido":t.customError?this._errorElement.textContent="Valor não aceito":t.patternMismatch?this._errorElement.textContent="Formato inválido":t.rangeOverflow?this._errorElement.textContent="Valor muito alto":t.rangeUnderflow?this._errorElement.textContent="Valor muito baixo":t.stepMismatch?this._errorElement.textContent="Valor inválido":t.tooLong?this._errorElement.textContent="Muito longo":t.typeMismatch?this._errorElement.textContent="Tipo de dado inválido":t.valueMissing&&(this._errorElement.textContent="Campo obrigatório")}},{key:"_hideInputError",value:function(e){this._errorElement=this._form.querySelector(".form__".concat(e.id,"-error")),e.classList.remove(this._errorClass),this._errorElement.textContent=""}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validity)}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled","")):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled"))}},{key:"_setEventListener",value:function(){var e=this;this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._buttonElement=this._form.querySelector(this._submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._setEventListener()}}])&&c(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function f(e){var t=function(e){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==a(t)?t:t+""}var p=function(){return e=function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=r,this._render=o,this._selector=document.querySelector(n)},(t=[{key:"renderer",value:function(){var e=this;this._items.forEach((function(t){e._render(t)}))}},{key:"addItem",value:function(e){this._selector.append(e)}}])&&s(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function v(e){var t=function(e){if("object"!=y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==y(t)?t:t+""}var b=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._selector=document.querySelector(t),this.open=this.open.bind(this),this._selector||console.log("Erro no seletor passado")},(t=[{key:"open",value:function(){this._selector.classList.add("grid__display_opened")}},{key:"close",value:function(){this._selector.classList.remove("grid__display_opened")}},{key:"_handleEscClose",value:function(e){this.close(),removeEventListener("keydown",this._handleEscClose)}},{key:"setEventListener",value:function(){var e,t,n=this;document.addEventListener("keydown",(function(e){"Escape"===e.key&&n._handleEscClose()})),null===(e=this._selector.querySelector(".popup__closer"))||void 0===e||e.addEventListener("click",(function(){n.close()})),null===(t=this._selector.querySelector("#popupOverlay"))||void 0===t||t.addEventListener("click",(function(e){e.target===e.currentTarget&&n.close()})),this._selector.addEventListener("click",(function(e){e.target===e.currentTarget&&n.close()}))}}])&&d(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function m(e){var t=function(e){if("object"!=h(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==h(t)?t:t+""}function g(e,t,n){return t=E(t),function(e,t){if(t&&("object"==h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,k()?Reflect.construct(t,n||[],E(e).constructor):t.apply(e,n))}function k(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(k=function(){return!!e})()}function S(e,t,n,r){var o=w(E(1&r?e.prototype:e),t,n);return 2&r?function(e){return o.apply(n,e)}:o}function w(){return w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=E(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},w.apply(null,arguments)}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}function O(e,t){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},O(e,t)}var j=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=g(this,t,[e]))._callback=n,r._isLoading=!1,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(t,e),n=t,(r=[{key:"_getInputValues",value:function(){var e,t,n,r;return{name:null===(e=this._selector.querySelector(".form__input-name"))||void 0===e?void 0:e.value,link:null===(t=this._selector.querySelector(".form__input-bio"))||void 0===t?void 0:t.value,about:null===(n=this._selector.querySelector(".form__input-bio"))||void 0===n?void 0:n.value,avatar:null===(r=this._selector.querySelector(".form__input-bio"))||void 0===r?void 0:r.value}}},{key:"close",value:function(){S(t,"close",this,3)([]),this._selector.querySelector(".form__button").classList.add("form__button_disabled"),this._selector.querySelector(".form__button").setAttribute("disabled",""),this._selector.querySelector(".form").reset()}},{key:"isLoading",value:function(e){var t=this._selector.querySelector(".form__button");this._isLoading=!this._isLoading,this._isLoading?t.textContent="Salvando...":t.textContent=e}},{key:"setEventListener",value:function(){var e=this;S(t,"setEventListener",this,3)([]),this._selector.querySelector(".form").addEventListener("submit",(function(t){t.preventDefault();var n=e._getInputValues();e._callback(n),e.isLoading("Salvar")}))}}])&&_(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(b);function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,L(r.key),r)}}function L(e){var t=function(e){if("object"!=C(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==C(t)?t:t+""}var q=function(){return e=function e(t){var n=t.name,r=t.bio,o=t.link;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=document.querySelector(n),this._bio=document.querySelector(r),this._link=document.querySelector(o)},(t=[{key:"getUserInfo",value:function(){return{name:this._name.textContent,bio:this._bio.textContent,link:this._link.src}}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about;this._name.textContent=t,this._bio.textContent=n}},{key:"setUserAvatar",value:function(e){this._link.src=e.avatar}}])&&P(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,x(r.key),r)}}function x(e){var t=function(e){if("object"!=T(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==T(t)?t:t+""}function U(e,t,n){return t=A(t),function(e,t){if(t&&("object"==T(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,D()?Reflect.construct(t,n||[],A(e).constructor):t.apply(e,n))}function D(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(D=function(){return!!e})()}function B(e,t,n,r){var o=R(A(1&r?e.prototype:e),t,n);return 2&r?function(e){return o.apply(n,e)}:o}function R(){return R="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=A(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},R.apply(null,arguments)}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}function V(e,t){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},V(e,t)}var N=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),U(this,t,[e])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V(e,t)}(t,e),n=t,(r=[{key:"open",value:function(e){this._selector.querySelector(".grid__display-image").src=e.link,this._selector.querySelector(".grid__display-image").alt=e.name,this._selector.querySelector(".grid__display-title").textContent=e.name,B(t,"open",this,3)([])}},{key:"close",value:function(){B(t,"close",this,3)([])}}])&&I(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(b);function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,z(r.key),r)}}function z(e){var t=function(e){if("object"!=M(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=M(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==M(t)?t:t+""}function H(e,t,n){return t=Q(t),function(e,t){if(t&&("object"==M(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,F()?Reflect.construct(t,n||[],Q(e).constructor):t.apply(e,n))}function F(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(F=function(){return!!e})()}function G(e,t,n,r){var o=K(Q(1&r?e.prototype:e),t,n);return 2&r?function(e){return o.apply(n,e)}:o}function K(){return K="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Q(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},K.apply(null,arguments)}function Q(e){return Q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Q(e)}function W(e,t){return W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},W(e,t)}var X=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=H(this,t,[e]))._deleteCallback=n,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&W(e,t)}(t,e),n=t,(r=[{key:"open",value:function(){G(t,"open",this,3)([])}},{key:"setEventListener",value:function(){var e=this;G(t,"setEventListener",this,3)([]),this._selector.querySelector(".form").addEventListener("submit",(function(t){t.preventDefault(),e._deleteCallback(),e.close()}))}}])&&J(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(b);function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){ee(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ee(e,t,n){return(t=ne(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ne(r.key),r)}}function ne(e){var t=function(e){if("object"!=Y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Y(t)?t:t+""}var re=function(){return e=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=t,this._options=n},(t=[{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),this._options).then((function(e){return e.ok?e.json():Promise.reject("Error manual: ".concat(e.status))})).catch((function(e){console.log("Vix paizao, deu ruim ó: ".concat(e))}))}},{key:"getUser",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),this._options).then((function(e){return e.ok?e.json():Promise.reject("Vixe amigo, erro ó: ".concat(e.status))}))}},{key:"setNewUser",value:function(e){fetch("".concat(this._baseUrl,"/users/me"),$($({method:"PATCH"},this._options),{},{body:JSON.stringify({name:e.name,about:e.about})}))}},{key:"setNewAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),$($({method:"PATCH"},this._options),{},{body:JSON.stringify({avatar:e.link})}))}},{key:"setNewCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),$($({method:"POST"},this._options),{},{body:JSON.stringify({name:e.name,link:e.link})})).then((function(e){return e.ok?e.json():Promise.reject("Post não enviado corretamente: ".concat(e.status))})).catch((function(e){console.log("Erro ao enviar novo Card: ".concat(e))}))}},{key:"apiLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),$({method:"PUT"},this._options)).then((function(e){return e.ok?e.json():Promise.reject("Erro de like: ".concat(e.status))}))}},{key:"apiDislike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),$({method:"DELETE"},this._options)).then((function(e){return e.ok?e.json():Promise.reject("Erro de dislike: ".concat(e.status))}))}},{key:"deleteCard",value:function(e){fetch("".concat(this._baseUrl,"/cards/").concat(e),$({method:"DELETE"},this._options)).then((function(e){console.log("Delete feito: ".concat(e))}))}}])&&te(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),oe=e.p+"cc6deb7349d71ca7a583.png",ie=new re("https://around.nomoreparties.co/v1/web-ptbr-cohort-12",{headers:{authorization:"c5f89901-0404-4ab2-ab83-c8e3c6dc51b4","Content-Type":"application/json"}});document.getElementById("closeIcon").src=oe;var ce=document.querySelector(".profile"),ue=ce.querySelector(".profile__button-add-post"),le=ce.querySelector(".profile__button-open-form"),ae=ce.querySelector(".profile__edit-pencil");ie.getUser().then((function(e){var t=e._id;ie.getInitialCards().then((function(e){var n=new p({items:e,renderer:function(e){var r=new o(e,"#grid",t,(function(e){var t=new N(".grid__display");t.open(e),t.setEventListener()}),(function(){var t=new X("#popupDeletePost",(function(){ie.deleteCard(e._id),r.deleteCard()}));t.open(),t.setEventListener()}),(function(){return e.likes.some((function(e){return e._id===t}))?ie.apiDislike(r._id).then((function(t){r.setLike(!1,t.likes.length),e.likes=t.likes})):ie.apiLike(r._id).then((function(t){r.setLike(!0,t.likes.length),e.likes=t.likes}))}));ie.getUser().then((function(t){t._id===e.owner._id&&r.addDeleteIcon()}));var i=r.generateCard(e);n.addItem(i)}},".grid");n.renderer()}))}));var se=new q({name:".profile__info-name",bio:".profile__info-bio",link:".profile__photo"});ie.getUser().then((function(e){se.setUserInfo(e),se.setUserAvatar(e)}));var fe=new j("#popupPost",(function(e){ie.getUser().then((function(t){var n=t._id,r=new o(e,"#grid",n,(function(e){var t=new N(".grid__display");t.open(e),t.setEventListener()}),(function(){}),(function(){})),i=document.querySelector(".grid");ie.setNewCard(e).then((function(e){r._id=e._id,r._handleDeleteClick=function(){var e=new X("#popupDeletePost",(function(){ie.deleteCard(r._id),r.deleteCard()}));e.open(),e.setEventListener()},r._handleLikeClick=function(){return e.likes.some((function(e){return e._id===n}))?ie.apiDislike(r._id).then((function(t){r.setLike(!1,t.likes.length),e.likes=t.likes})):ie.apiLike(r._id).then((function(t){r.setLike(!0,t.likes.length),e.likes=t.likes}))};var t=r.generateCard(e);ie.getUser().then((function(t){t._id===e.owner._id&&r.addDeleteIcon()})),i.prepend(t),fe.close(),fe.isLoading("Crie")}))}))}));fe.setEventListener();var pe=new j("#popupUser",(function(e){se.setUserInfo(e),ie.setNewUser(e),pe.close(),pe.isLoading("Salvar")}));pe.setEventListener();var ye=new j("#popupUserAvatar",(function(e){se.setUserAvatar(e),ie.setNewAvatar(e),ye.close(),ye.isLoading("Salvar")}));ye.setEventListener(),ae.addEventListener("click",(function(){ye.open()})),le.addEventListener("click",(function(){var e=se.getUserInfo();document.querySelector(".form__input-name").value=e.name,document.querySelector(".form__input-bio").value=e.bio,pe.open()})),ue.addEventListener("click",(function(){fe.open()}));var de={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input-error-message",errorClass:"form__input-error"};Array.from(document.querySelectorAll(de.formSelector)).forEach((function(e){new l(de,e).enableValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R0FDRixHQUNGLElBQ0EyRCxHQUFVYixtQkFFVixJQUFNbUIsR0FBWSxJQUFJbEYsRUFBYyxjQUFjLFNBQUM3SCxHQUNqRHNNLEdBQVNDLFlBQVl2TSxHQUNyQjRLLEdBQUlvQyxXQUFXaE4sR0FDZitNLEdBQVV6RixRQUNWeUYsR0FBVWpFLFVBQVUsU0FDdEIsSUFDQWlFLEdBQVVuQixtQkFFVixJQUFNcUIsR0FBYyxJQUFJcEYsRUFBYyxvQkFBb0IsU0FBQzdILEdBQ3pEc00sR0FBU0UsY0FBY3hNLEdBQ3ZCNEssR0FBSXNDLGFBQWFsTixHQUNqQmlOLEdBQVkzRixRQUNaMkYsR0FBWW5FLFVBQVUsU0FDeEIsSUFDQW1FLEdBQVlyQixtQkFFWlIsR0FBaUJ4SixpQkFBaUIsU0FBUyxXQUN6Q3FMLEdBQVloRyxNQUNkLElBRUFrRSxHQUFldkosaUJBQWlCLFNBQVMsV0FDdkMsSUFBTXVMLEVBQWlCYixHQUFTYyxjQUNoQzlMLFNBQVNDLGNBQWMscUJBQXFCRixNQUFROEwsRUFBZTFNLEtBQ25FYSxTQUFTQyxjQUFjLG9CQUFvQkYsTUFBUThMLEVBQWVuRSxJQUNsRStELEdBQVU5RixNQUNaLElBQ0FpRSxHQUFjdEosaUJBQWlCLFNBQVMsV0FDdEM2SyxHQUFVeEYsTUFDWixJQUVBLElBQU1vRyxHQUFZLENBQ2hCMUosYUFBYyxRQUNkRSxjQUFlLGVBQ2ZFLHFCQUFzQixnQkFDdEJFLG9CQUFxQix3QkFDckJFLGdCQUFpQiw0QkFDakJFLFdBQVkscUJBR0d5QixNQUFNQyxLQUFLekUsU0FBUzBFLGlCQUFpQnFILEdBQVUxSixlQUN2RHVDLFNBQVEsU0FBQ29ILEdBQ08sSUFBSWhLLEVBQWErSixHQUFXQyxHQUNqQkMsa0JBQ3BDLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBkYXRhLFxyXG4gICAgdGVtcGxhdGVTZWxlY3RvcixcclxuICAgIHVzZXJJZCxcclxuICAgIGhhbmRsZUNhcmRDbGljayxcclxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxyXG4gICAgaGFuZGxlTGlrZUNsaWNrXHJcbiAgKSB7XHJcbiAgICB0aGlzLl90aXRsZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2ltYWdlID0gZGF0YS5saW5rO1xyXG5cclxuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcclxuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcyB8fCBbXTtcclxuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XHJcbiAgICB0aGlzLl90ZW1wbGF0ZSA9IHRlbXBsYXRlU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGVtcGxhdGUpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ3JpZF9fYm94XCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgcmV0dXJuIGNhcmRUZW1wbGF0ZTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2VsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZ3JpZF9fZGVsZXRlLWJ1dHRvblwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVUcmFzaENsaWNrKCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2VsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZ3JpZF9fYm94LXBvcnRyYWl0LXBob3RvXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgdGhpcy5fZWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5ncmlkX19jb250ZW50LWxpa2VcIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZSgpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVUcmFzaENsaWNrKCkge1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2soKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVJbWFnZUNsaWNrKCkge1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHsgbmFtZTogdGhpcy5fdGl0bGUsIGxpbms6IHRoaXMuX2ltYWdlIH0pO1xyXG4gIH1cclxuXHJcbiAgc2V0TGlrZShpc0xpa2VkLCBsaWtlc0NvdW50KSB7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcclxuICAgIHRoaXMuX2xpa2VDYXJkID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdyaWRfX2NvbnRlbnQtbGlrZVwiKTtcclxuXHJcbiAgICBpZiAodGhpcy5faXNMaWtlZCkge1xyXG4gICAgICB0aGlzLl9saWtlQ2FyZC5jbGFzc0xpc3QuYWRkKFwiZ3JpZF9fY29udGVudC1saWtlX2FjdGl2ZVwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2xpa2VDYXJkLmNsYXNzTGlzdC5yZW1vdmUoXCJncmlkX19jb250ZW50LWxpa2VfYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdyaWRfX2NvbnRlbnQtbGlrZU51bWJlclwiKS50ZXh0Q29udGVudCA9XHJcbiAgICAgIGxpa2VzQ291bnQ7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlTGlrZSgpIHtcclxuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzLl9pZCwgdGhpcy5faXNMaWtlZClcclxuICAgICAgLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XHJcbiAgICAgICAgdGhpcy5zZXRMaWtlKCF0aGlzLl9pc0xpa2VkLCB1cGRhdGVkQ2FyZC5saWtlcy5sZW5ndGgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKCkgPT4ge30pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgfVxyXG5cclxuICBhZGREZWxldGVJY29uKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5ncmlkX19kZWxldGUtYnV0dG9uXCIpXHJcbiAgICAgIC5jbGFzc0xpc3QuYWRkKFwiZ3JpZF9fZGVsZXRlLWJ1dHRvbl9zaG93XCIpO1xyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ3JpZF9fYm94LXBvcnRyYWl0LXBob3RvXCIpLnNyYyA9IHRoaXMuX2ltYWdlO1xyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdyaWRfX2JveC1wb3J0cmFpdC1waG90b1wiKS5hbHQgPSB0aGlzLl90aXRsZTtcclxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5ncmlkX19jb250ZW50LXRpdGxlXCIpLnRleHRDb250ZW50ID1cclxuICAgICAgdGhpcy5fdGl0bGU7XHJcblxyXG4gICAgY29uc3QgaGFzT3duTGlrZSA9IHRoaXMuX2xpa2VzLnNvbWUoKGxpa2UpID0+IGxpa2UuX2lkID09PSB0aGlzLl91c2VySWQpO1xyXG4gICAgdGhpcy5zZXRMaWtlKGhhc093bkxpa2UsIHRoaXMuX2xpa2VzLmxlbmd0aCk7XHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkaXR5IHtcclxuICBjb25zdHJ1Y3RvcihzZWxlY3RvciwgZm9ybSkge1xyXG4gICAgdGhpcy5fZm9ybSA9IGZvcm07XHJcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IgPSBzZWxlY3Rvci5mb3JtU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2VsZWN0b3IuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2VsZWN0b3Iuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2VsZWN0b3IuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNlbGVjdG9yLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZWxlY3Rvci5lcnJvckNsYXNzO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JWYWxpZCkge1xyXG4gICAgdGhpcy5fZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLmZvcm1fXyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuXHJcbiAgICBpZiAoZXJyb3JWYWxpZC50b29TaG9ydCkge1xyXG4gICAgICB0aGlzLl9lcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIk11aXRvIGN1cnRvXCI7XHJcbiAgICB9IGVsc2UgaWYgKGVycm9yVmFsaWQuYmFkSW5wdXQpIHtcclxuICAgICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJDYW1wbyBpbnbDoWxpZG9cIjtcclxuICAgIH0gZWxzZSBpZiAoZXJyb3JWYWxpZC5jdXN0b21FcnJvcikge1xyXG4gICAgICB0aGlzLl9lcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlZhbG9yIG7Do28gYWNlaXRvXCI7XHJcbiAgICB9IGVsc2UgaWYgKGVycm9yVmFsaWQucGF0dGVybk1pc21hdGNoKSB7XHJcbiAgICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiRm9ybWF0byBpbnbDoWxpZG9cIjtcclxuICAgIH0gZWxzZSBpZiAoZXJyb3JWYWxpZC5yYW5nZU92ZXJmbG93KSB7XHJcbiAgICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiVmFsb3IgbXVpdG8gYWx0b1wiO1xyXG4gICAgfSBlbHNlIGlmIChlcnJvclZhbGlkLnJhbmdlVW5kZXJmbG93KSB7XHJcbiAgICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiVmFsb3IgbXVpdG8gYmFpeG9cIjtcclxuICAgIH0gZWxzZSBpZiAoZXJyb3JWYWxpZC5zdGVwTWlzbWF0Y2gpIHtcclxuICAgICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJWYWxvciBpbnbDoWxpZG9cIjtcclxuICAgIH0gZWxzZSBpZiAoZXJyb3JWYWxpZC50b29Mb25nKSB7XHJcbiAgICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiTXVpdG8gbG9uZ29cIjtcclxuICAgIH0gZWxzZSBpZiAoZXJyb3JWYWxpZC50eXBlTWlzbWF0Y2gpIHtcclxuICAgICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJUaXBvIGRlIGRhZG8gaW52w6FsaWRvXCI7XHJcbiAgICB9IGVsc2UgaWYgKGVycm9yVmFsaWQudmFsdWVNaXNzaW5nKSB7XHJcbiAgICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiQ2FtcG8gb2JyaWdhdMOzcmlvXCI7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAuZm9ybV9fJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkaXR5KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwiXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXIoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXIoKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY2xhc3NTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fc2VsZWN0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNsYXNzU2VsZWN0b3IpO1xyXG4gIH1cclxuICByZW5kZXJlcigpIHtcclxuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGFkZEl0ZW0oaXRlbSkge1xyXG4gICAgdGhpcy5fc2VsZWN0b3IuYXBwZW5kKGl0ZW0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fc2VsZWN0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5vcGVuID0gdGhpcy5vcGVuLmJpbmQodGhpcyk7XHJcbiAgICBpZiAoIXRoaXMuX3NlbGVjdG9yKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiRXJybyBubyBzZWxldG9yIHBhc3NhZG9cIik7XHJcbiAgICB9XHJcbiAgfVxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9zZWxlY3Rvci5jbGFzc0xpc3QuYWRkKFwiZ3JpZF9fZGlzcGxheV9vcGVuZWRcIik7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fc2VsZWN0b3IuY2xhc3NMaXN0LnJlbW92ZShcImdyaWRfX2Rpc3BsYXlfb3BlbmVkXCIpO1xyXG4gIH1cclxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICByZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG4gIHNldEV2ZW50TGlzdGVuZXIoKSB7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZWxlY3RvclxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2VyXCIpXHJcbiAgICAgID8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgdGhpcy5fc2VsZWN0b3JcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXBPdmVybGF5XCIpXHJcbiAgICAgID8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gZXZ0LmN1cnJlbnRUYXJnZXQpIHtcclxuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgdGhpcy5fc2VsZWN0b3IuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgaWYgKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHNlbGVjdG9yLCBjYWxsYmFjaykge1xyXG4gICAgc3VwZXIoc2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fY2FsbGJhY2sgPSBjYWxsYmFjaztcclxuICAgIHRoaXMuX2lzTG9hZGluZyA9IGZhbHNlO1xyXG4gIH1cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiB0aGlzLl9zZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0LW5hbWVcIik/LnZhbHVlLFxyXG4gICAgICBsaW5rOiB0aGlzLl9zZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0LWJpb1wiKT8udmFsdWUsXHJcbiAgICAgIGFib3V0OiB0aGlzLl9zZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0LWJpb1wiKT8udmFsdWUsXHJcbiAgICAgIGF2YXRhcjogdGhpcy5fc2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5mb3JtX19pbnB1dC1iaW9cIik/LnZhbHVlLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuX3NlbGVjdG9yXHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2J1dHRvblwiKVxyXG4gICAgICAuY2xhc3NMaXN0LmFkZChcImZvcm1fX2J1dHRvbl9kaXNhYmxlZFwiKTtcclxuICAgIHRoaXMuX3NlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fYnV0dG9uXCIpLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwiXCIpO1xyXG4gICAgdGhpcy5fc2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpLnJlc2V0KCk7XHJcbiAgfVxyXG5cclxuICBpc0xvYWRpbmcobWVzc2FnZSkge1xyXG4gICAgY29uc3Qgc3VibWl0QnV0dG9uID0gdGhpcy5fc2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5mb3JtX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9pc0xvYWRpbmcgPSAhdGhpcy5faXNMb2FkaW5nO1xyXG4gICAgaWYgKHRoaXMuX2lzTG9hZGluZykge1xyXG4gICAgICBzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhbHZhbmRvLi4uXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBtZXNzYWdlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcigpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXIoKTtcclxuICAgIHRoaXMuX3NlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xyXG4gICAgICB0aGlzLl9jYWxsYmFjayhkYXRhKTtcclxuICAgICAgdGhpcy5pc0xvYWRpbmcoXCJTYWx2YXJcIik7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZSwgYmlvLCBsaW5rIH0pIHtcclxuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWUpO1xyXG4gICAgdGhpcy5fYmlvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihiaW8pO1xyXG4gICAgdGhpcy5fbGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobGluayk7XHJcbiAgfVxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgYmlvOiB0aGlzLl9iaW8udGV4dENvbnRlbnQsXHJcbiAgICAgIGxpbms6IHRoaXMuX2xpbmsuc3JjLFxyXG4gICAgfTtcclxuICB9XHJcbiAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2Jpby50ZXh0Q29udGVudCA9IGFib3V0O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckF2YXRhcihkYXRhKSB7XHJcbiAgICB0aGlzLl9saW5rLnNyYyA9IGRhdGEuYXZhdGFyO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihzZWxlY3Rvcik7XHJcbiAgfVxyXG4gIG9wZW4oaW1hZ2UpIHtcclxuICAgIHRoaXMuX3NlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIuZ3JpZF9fZGlzcGxheS1pbWFnZVwiKS5zcmMgPSBpbWFnZS5saW5rO1xyXG4gICAgdGhpcy5fc2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5ncmlkX19kaXNwbGF5LWltYWdlXCIpLmFsdCA9IGltYWdlLm5hbWU7XHJcbiAgICBjb25zdCBzdWJ0aXRsZURpc3BsYXkgPSB0aGlzLl9zZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5ncmlkX19kaXNwbGF5LXRpdGxlXCJcclxuICAgICk7XHJcbiAgICBzdWJ0aXRsZURpc3BsYXkudGV4dENvbnRlbnQgPSBpbWFnZS5uYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxuICBjbG9zZSgpIHtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3RvcihzZWxlY3RvciwgZGVsZXRlQ2FsbGJhY2spIHtcclxuICAgIHN1cGVyKHNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2RlbGV0ZUNhbGxiYWNrID0gZGVsZXRlQ2FsbGJhY2s7XHJcbiAgfVxyXG4gIG9wZW4oKSB7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG4gIHNldEV2ZW50TGlzdGVuZXIoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVyKCk7XHJcbiAgICB0aGlzLl9zZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIikuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9kZWxldGVDYWxsYmFjaygpO1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihiYXNlVVJMLCBvcHRpb25zKSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVSTDtcclxuICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zO1xyXG4gIH1cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB0aGlzLl9vcHRpb25zKVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3IgbWFudWFsOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFZpeCBwYWl6YW8sIGRldSBydWltIMOzOiAke2Vycm9yfWApO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldFVzZXIoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB0aGlzLl9vcHRpb25zKS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgVml4ZSBhbWlnbywgZXJybyDDszogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbiAgc2V0TmV3VXNlcihkYXRhKSB7XHJcbiAgICBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIC4uLnRoaXMuX29wdGlvbnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IGRhdGEuYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIHNldE5ld0F2YXRhcihkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgLi4udGhpcy5fb3B0aW9ucyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogZGF0YS5saW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuICBzZXROZXdDYXJkKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgLi4udGhpcy5fb3B0aW9ucyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcclxuICAgICAgICBsaW5rOiBkYXRhLmxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYFBvc3QgbsOjbyBlbnZpYWRvIGNvcnJldGFtZW50ZTogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBFcnJvIGFvIGVudmlhciBub3ZvIENhcmQ6ICR7ZXJyb3J9YCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYXBpTGlrZShpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7aWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIC4uLnRoaXMuX29wdGlvbnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJybyBkZSBsaWtlOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuICBhcGlEaXNsaWtlKGlkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtpZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgLi4udGhpcy5fb3B0aW9ucyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvIGRlIGRpc2xpa2U6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGlkKSB7XHJcbiAgICBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICAuLi50aGlzLl9vcHRpb25zLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBEZWxldGUgZmVpdG86ICR7cmVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBcIi4vbWFpbi5jc3NcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRpdHkgZnJvbSBcIi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoQ29uZmlybWF0aW9uIH0gZnJvbSBcIi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgY2xvc2VJY29ucG5nIGZyb20gXCIuL2ltYWdlcy9wb3B1cF9fY2xvc2VpY29uLnBuZ1wiO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaShgaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS93ZWItcHRici1jb2hvcnQtMTJgLCB7XHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJjNWY4OTkwMS0wNDA0LTRhYjItYWI4My1jOGUzYzZkYzUxYjRcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuY29uc3QgY2xvc2VJY29uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjbG9zZUljb25cIik7XHJcbmNsb3NlSWNvbi5zcmMgPSBjbG9zZUljb25wbmc7XHJcblxyXG5jb25zdCBwcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlXCIpO1xyXG5jb25zdCBhZGRQb3N0QnV0dG9uID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2J1dHRvbi1hZGQtcG9zdFwiKTtcclxuY29uc3QgYnV0dG9uT3BlbkZvcm0gPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYnV0dG9uLW9wZW4tZm9ybVwiKTtcclxuY29uc3QgZWRpdEF2YXRhckJ1dHRvbiA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LXBlbmNpbFwiKTtcclxuXHJcbmFwaS5nZXRVc2VyKCkudGhlbigodXNlckRhdGEpID0+IHtcclxuICBjb25zdCB1c2VySWQgPSB1c2VyRGF0YS5faWQ7XHJcbiAgYXBpLmdldEluaXRpYWxDYXJkcygpLnRoZW4oKGluaXRpYWxDYXJkcykgPT4ge1xyXG4gICAgY29uc3Qgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcclxuICAgICAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcclxuICAgICAgICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgICAgICAgICAgaXRlbSxcclxuICAgICAgICAgICAgXCIjZ3JpZFwiLFxyXG4gICAgICAgICAgICB1c2VySWQsXHJcbiAgICAgICAgICAgIChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIuZ3JpZF9fZGlzcGxheVwiKTtcclxuICAgICAgICAgICAgICBwb3B1cFdpdGhJbWFnZS5vcGVuKGRhdGEpO1xyXG4gICAgICAgICAgICAgIHBvcHVwV2l0aEltYWdlLnNldEV2ZW50TGlzdGVuZXIoKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGRlbGV0ZUZvcm0gPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKFxyXG4gICAgICAgICAgICAgICAgXCIjcG9wdXBEZWxldGVQb3N0XCIsXHJcbiAgICAgICAgICAgICAgICAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIGFwaS5kZWxldGVDYXJkKGl0ZW0uX2lkKTtcclxuICAgICAgICAgICAgICAgICAgY2FyZC5kZWxldGVDYXJkKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgZGVsZXRlRm9ybS5vcGVuKCk7XHJcbiAgICAgICAgICAgICAgZGVsZXRlRm9ybS5zZXRFdmVudExpc3RlbmVyKCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgICBjb25zdCBoYXNPd25MaWtlID0gaXRlbS5saWtlcy5zb21lKChsaWtlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbGlrZS5faWQgPT09IHVzZXJJZDtcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICBpZiAoaGFzT3duTGlrZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFwaS5hcGlEaXNsaWtlKGNhcmQuX2lkKS50aGVuKCh1cGRhdGVkQ2FyZCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICBjYXJkLnNldExpa2UoZmFsc2UsIHVwZGF0ZWRDYXJkLmxpa2VzLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICAgIGl0ZW0ubGlrZXMgPSB1cGRhdGVkQ2FyZC5saWtlcztcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYXBpLmFwaUxpa2UoY2FyZC5faWQpLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIGNhcmQuc2V0TGlrZSh0cnVlLCB1cGRhdGVkQ2FyZC5saWtlcy5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgICBpdGVtLmxpa2VzID0gdXBkYXRlZENhcmQubGlrZXM7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgYXBpLmdldFVzZXIoKS50aGVuKCh1c2VyRGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodXNlckRhdGEuX2lkID09PSBpdGVtLm93bmVyLl9pZCkge1xyXG4gICAgICAgICAgICAgIGNhcmQuYWRkRGVsZXRlSWNvbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVDYXJkKGl0ZW0pO1xyXG4gICAgICAgICAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgICBcIi5ncmlkXCJcclxuICAgICk7XHJcbiAgICBzZWN0aW9uLnJlbmRlcmVyKCk7XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWU6IFwiLnByb2ZpbGVfX2luZm8tbmFtZVwiLFxyXG4gIGJpbzogXCIucHJvZmlsZV9faW5mby1iaW9cIixcclxuICBsaW5rOiBcIi5wcm9maWxlX19waG90b1wiLFxyXG59KTtcclxuXHJcbmFwaS5nZXRVc2VyKCkudGhlbigodXNlckRhdGEpID0+IHtcclxuICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YSk7XHJcbiAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YSk7XHJcbn0pO1xyXG5cclxuY29uc3QgcG9wdXBGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcG9wdXBQb3N0XCIsIChkYXRhKSA9PiB7XHJcbiAgYXBpLmdldFVzZXIoKS50aGVuKCh1c2VyRGF0YSkgPT4ge1xyXG4gICAgY29uc3QgdXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG5cclxuICAgIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZChcclxuICAgICAgZGF0YSxcclxuICAgICAgXCIjZ3JpZFwiLFxyXG4gICAgICB1c2VySWQsXHJcbiAgICAgIChkYXRhKSA9PiB7XHJcbiAgICAgICAgY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIuZ3JpZF9fZGlzcGxheVwiKTtcclxuICAgICAgICBwb3B1cFdpdGhJbWFnZS5vcGVuKGRhdGEpO1xyXG4gICAgICAgIHBvcHVwV2l0aEltYWdlLnNldEV2ZW50TGlzdGVuZXIoKTtcclxuICAgICAgfSxcclxuICAgICAgKCkgPT4ge30sXHJcbiAgICAgICgpID0+IHt9XHJcbiAgICApO1xyXG4gICAgY29uc3QgZmVlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ3JpZFwiKTtcclxuICAgIGFwaS5zZXROZXdDYXJkKGRhdGEpLnRoZW4oKGNhcmQpID0+IHtcclxuICAgICAgbmV3Q2FyZC5faWQgPSBjYXJkLl9pZDtcclxuICAgICAgbmV3Q2FyZC5faGFuZGxlRGVsZXRlQ2xpY2sgPSAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgZGVsZXRlRm9ybSA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXCIjcG9wdXBEZWxldGVQb3N0XCIsICgpID0+IHtcclxuICAgICAgICAgIGFwaS5kZWxldGVDYXJkKG5ld0NhcmQuX2lkKTtcclxuICAgICAgICAgIG5ld0NhcmQuZGVsZXRlQ2FyZCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGRlbGV0ZUZvcm0ub3BlbigpO1xyXG4gICAgICAgIGRlbGV0ZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcigpO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgbmV3Q2FyZC5faGFuZGxlTGlrZUNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGhhc093bkxpa2UgPSBjYXJkLmxpa2VzLnNvbWUoKGxpa2UpID0+IHtcclxuICAgICAgICAgIHJldHVybiBsaWtlLl9pZCA9PT0gdXNlcklkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChoYXNPd25MaWtlKSB7XHJcbiAgICAgICAgICByZXR1cm4gYXBpLmFwaURpc2xpa2UobmV3Q2FyZC5faWQpLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XHJcbiAgICAgICAgICAgIG5ld0NhcmQuc2V0TGlrZShmYWxzZSwgdXBkYXRlZENhcmQubGlrZXMubGVuZ3RoKTtcclxuICAgICAgICAgICAgY2FyZC5saWtlcyA9IHVwZGF0ZWRDYXJkLmxpa2VzO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiBhcGkuYXBpTGlrZShuZXdDYXJkLl9pZCkudGhlbigodXBkYXRlZENhcmQpID0+IHtcclxuICAgICAgICAgICAgbmV3Q2FyZC5zZXRMaWtlKHRydWUsIHVwZGF0ZWRDYXJkLmxpa2VzLmxlbmd0aCk7XHJcbiAgICAgICAgICAgIGNhcmQubGlrZXMgPSB1cGRhdGVkQ2FyZC5saWtlcztcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IG5ld0NhcmRFbGVtZW50ID0gbmV3Q2FyZC5nZW5lcmF0ZUNhcmQoY2FyZCk7XHJcbiAgICAgIGFwaS5nZXRVc2VyKCkudGhlbigodXNlckRhdGEpID0+IHtcclxuICAgICAgICBpZiAodXNlckRhdGEuX2lkID09PSBjYXJkLm93bmVyLl9pZCkge1xyXG4gICAgICAgICAgbmV3Q2FyZC5hZGREZWxldGVJY29uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGZlZWQucHJlcGVuZChuZXdDYXJkRWxlbWVudCk7XHJcbiAgICAgIHBvcHVwRm9ybS5jbG9zZSgpO1xyXG4gICAgICBwb3B1cEZvcm0uaXNMb2FkaW5nKFwiQ3JpZVwiKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59KTtcclxucG9wdXBGb3JtLnNldEV2ZW50TGlzdGVuZXIoKTtcclxuXHJcbmNvbnN0IHBvcHVwVXNlciA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3BvcHVwVXNlclwiLCAoZGF0YSkgPT4ge1xyXG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xyXG4gIGFwaS5zZXROZXdVc2VyKGRhdGEpO1xyXG4gIHBvcHVwVXNlci5jbG9zZSgpO1xyXG4gIHBvcHVwVXNlci5pc0xvYWRpbmcoXCJTYWx2YXJcIik7XHJcbn0pO1xyXG5wb3B1cFVzZXIuc2V0RXZlbnRMaXN0ZW5lcigpO1xyXG5cclxuY29uc3QgcG9wdXBBdmF0YXIgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNwb3B1cFVzZXJBdmF0YXJcIiwgKGRhdGEpID0+IHtcclxuICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKGRhdGEpO1xyXG4gIGFwaS5zZXROZXdBdmF0YXIoZGF0YSk7XHJcbiAgcG9wdXBBdmF0YXIuY2xvc2UoKTtcclxuICBwb3B1cEF2YXRhci5pc0xvYWRpbmcoXCJTYWx2YXJcIik7XHJcbn0pO1xyXG5wb3B1cEF2YXRhci5zZXRFdmVudExpc3RlbmVyKCk7XHJcblxyXG5lZGl0QXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgcG9wdXBBdmF0YXIub3BlbigpO1xyXG59KTtcclxuXHJcbmJ1dHRvbk9wZW5Gb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3QgY3VycmVudFByb2ZpbGUgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXQtbmFtZVwiKS52YWx1ZSA9IGN1cnJlbnRQcm9maWxlLm5hbWU7XHJcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX19pbnB1dC1iaW9cIikudmFsdWUgPSBjdXJyZW50UHJvZmlsZS5iaW87XHJcbiAgcG9wdXBVc2VyLm9wZW4oKTtcclxufSk7XHJcbmFkZFBvc3RCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBwb3B1cEZvcm0ub3BlbigpO1xyXG59KTtcclxuXHJcbmNvbnN0IHNlbGVjdG9ycyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLmZvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImZvcm1fX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJmb3JtX19pbnB1dC1lcnJvci1tZXNzYWdlXCIsXHJcbiAgZXJyb3JDbGFzczogXCJmb3JtX19pbnB1dC1lcnJvclwiLFxyXG59O1xyXG5cclxuY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3JzLmZvcm1TZWxlY3RvcikpO1xyXG5mb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gIGNvbnN0IGZvcm1WYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGl0eShzZWxlY3RvcnMsIGZvcm1FbGVtZW50KTtcclxuICBjb25zdCBmb3JtRW5hYmxlID0gZm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG59KTtcclxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJwIiwiQ2FyZCIsImRhdGEiLCJ0ZW1wbGF0ZVNlbGVjdG9yIiwidXNlcklkIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aGlzIiwiX3RpdGxlIiwibmFtZSIsIl9pbWFnZSIsImxpbmsiLCJfdXNlcklkIiwiX2xpa2VzIiwibGlrZXMiLCJfaWQiLCJfaGFuZGxlTGlrZUNsaWNrIiwiX3RlbXBsYXRlIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsImtleSIsInZhbHVlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl90aGlzIiwiX2VsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZVRyYXNoQ2xpY2siLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVMaWtlIiwiaXNMaWtlZCIsImxpa2VzQ291bnQiLCJfaXNMaWtlZCIsIl9saWtlQ2FyZCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsInRleHRDb250ZW50IiwiX3RoaXMyIiwidGhlbiIsInVwZGF0ZWRDYXJkIiwic2V0TGlrZSIsImxlbmd0aCIsImNhdGNoIiwiX3RoaXMzIiwiX2dldFRlbXBsYXRlIiwic3JjIiwiYWx0IiwiaGFzT3duTGlrZSIsInNvbWUiLCJsaWtlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiRm9ybVZhbGlkaXR5Iiwic2VsZWN0b3IiLCJmb3JtIiwiX2Zvcm0iLCJfZm9ybVNlbGVjdG9yIiwiZm9ybVNlbGVjdG9yIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JWYWxpZCIsIl9lcnJvckVsZW1lbnQiLCJjb25jYXQiLCJpZCIsInRvb1Nob3J0IiwiYmFkSW5wdXQiLCJjdXN0b21FcnJvciIsInBhdHRlcm5NaXNtYXRjaCIsInJhbmdlT3ZlcmZsb3ciLCJyYW5nZVVuZGVyZmxvdyIsInN0ZXBNaXNtYXRjaCIsInRvb0xvbmciLCJ0eXBlTWlzbWF0Y2giLCJ2YWx1ZU1pc3NpbmciLCJfaW5wdXRMaXN0IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfYnV0dG9uRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJmb3JFYWNoIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl9zZXRFdmVudExpc3RlbmVyIiwiU2VjdGlvbiIsIl9yZWYiLCJjbGFzc1NlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXIiLCJfc2VsZWN0b3IiLCJpdGVtIiwiYXBwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwib3BlbiIsImJpbmQiLCJjb25zb2xlIiwibG9nIiwiZXZ0IiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiX2hhbmRsZUVzY0Nsb3NlIiwiX3RoaXMkX3NlbGVjdG9yJHF1ZXJ5IiwiX3RoaXMkX3NlbGVjdG9yJHF1ZXJ5MiIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJQb3B1cFdpdGhGb3JtIiwiX1BvcHVwIiwiY2FsbGJhY2siLCJfY2FsbFN1cGVyIiwiX2NhbGxiYWNrIiwiX2lzTG9hZGluZyIsIl9pbmhlcml0cyIsIl90aGlzJF9zZWxlY3RvciRxdWVyeTMiLCJfdGhpcyRfc2VsZWN0b3IkcXVlcnk0IiwiYWJvdXQiLCJhdmF0YXIiLCJfc3VwZXJQcm9wR2V0IiwicmVzZXQiLCJtZXNzYWdlIiwic3VibWl0QnV0dG9uIiwicHJldmVudERlZmF1bHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpc0xvYWRpbmciLCJVc2VySW5mbyIsImJpbyIsIl9uYW1lIiwiX2JpbyIsIl9saW5rIiwiX3JlZjIiLCJQb3B1cFdpdGhJbWFnZSIsImltYWdlIiwiUG9wdXBXaXRoQ29uZmlybWF0aW9uIiwiZGVsZXRlQ2FsbGJhY2siLCJfZGVsZXRlQ2FsbGJhY2siLCJBcGkiLCJiYXNlVVJMIiwib3B0aW9ucyIsIl9iYXNlVXJsIiwiX29wdGlvbnMiLCJmZXRjaCIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJlcnJvciIsIl9vYmplY3RTcHJlYWQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFwaSIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwiZ2V0RWxlbWVudEJ5SWQiLCJjbG9zZUljb25wbmciLCJwcm9maWxlIiwiYWRkUG9zdEJ1dHRvbiIsImJ1dHRvbk9wZW5Gb3JtIiwiZWRpdEF2YXRhckJ1dHRvbiIsImdldFVzZXIiLCJ1c2VyRGF0YSIsImdldEluaXRpYWxDYXJkcyIsImluaXRpYWxDYXJkcyIsInNlY3Rpb24iLCJjYXJkIiwicG9wdXBXaXRoSW1hZ2UiLCJzZXRFdmVudExpc3RlbmVyIiwiZGVsZXRlRm9ybSIsImRlbGV0ZUNhcmQiLCJhcGlEaXNsaWtlIiwiYXBpTGlrZSIsIm93bmVyIiwiYWRkRGVsZXRlSWNvbiIsImNhcmRFbGVtZW50IiwiZ2VuZXJhdGVDYXJkIiwiYWRkSXRlbSIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwicG9wdXBGb3JtIiwibmV3Q2FyZCIsImZlZWQiLCJzZXROZXdDYXJkIiwibmV3Q2FyZEVsZW1lbnQiLCJwcmVwZW5kIiwicG9wdXBVc2VyIiwic2V0TmV3VXNlciIsInBvcHVwQXZhdGFyIiwic2V0TmV3QXZhdGFyIiwiY3VycmVudFByb2ZpbGUiLCJnZXRVc2VySW5mbyIsInNlbGVjdG9ycyIsImZvcm1FbGVtZW50IiwiZW5hYmxlVmFsaWRhdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=